<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans"
       xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:task="http://www.springframework.org/schema/task"
       xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd http://www.springframework.org/schema/task http://www.springframework.org/schema/task/spring-task.xsd">


    <task:scheduler id="schedulerTaskThreadPool" pool-size="10"/>

    <task:scheduler id="jobDispatcherThreadPool" pool-size="10"/>

    <!-- The Config of Schedule Task -->
    <bean id="scheduleTaskConfig" class="sun.spring.scheduler.core.ScheduleJobConfig">
        <property name="transactionManager" ref="transactionManager"/>
        <property name="jdbcTemplate" ref="jdbcTemplate"/>
        <property name="executorService" ref="schedulerTaskThreadPool"/>
    </bean>


    <bean id="demoScheduleJobDispatcher" class="sun.spring.scheduler.core.DefaultScheduleJobDispatcher">
        <property name="executorService" ref="jobDispatcherThreadPool"/>
        <property name="scheduleJobConfig" ref="scheduleTaskConfig"/>
        <property name="scheduleTasks">
            <list>
                <!--<ref bean="demoScheduleTask"/>-->
                <ref bean="demoBatchScheduleTask"/>
            </list>
        </property>
    </bean>

    <!--<bean id="demoScheduleTask" class="sun.spring.scheduler.core.DefaultScheduleTask">-->
    <!--<property name="scheduleTaskDetail" ref="demoTaskDetail"/>-->
    <!--<property name="scheduleJobConfig" ref="scheduleTaskConfig"/>-->
    <!--</bean>-->
    <!--<bean id="demoTaskDetail" class="sun.spring.scheduler.demo.DemoTaskDetail"/>-->


    <bean id="demoBatchScheduleTask" class="sun.spring.scheduler.core.DefaultScheduleTask">
        <property name="scheduleTaskDetail" ref="demoBatchTaskDetail"/>
        <property name="scheduleJobConfig" ref="scheduleTaskConfig"/>
    </bean>
    <bean id="demoBatchTaskDetail" class="sun.spring.scheduler.demo.DemoBatchTaskDetail">
        <property name="jdbcTemplate" ref="jdbcTemplate"/>
        <property name="job" ref="transferDataToRedisJob"/>
        <property name="jobLauncher" ref="jobLauncher"/>
    </bean>

     <!--Schedule tasks-->
    <task:scheduled-tasks scheduler="schedulerTaskThreadPool">
        <task:scheduled ref="demoScheduleJobDispatcher" method="run" fixed-rate="60000"/>
    </task:scheduled-tasks>


</beans>